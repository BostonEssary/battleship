(()=>{"use strict";const e=class{hits=0;sunk=!1;coords=[];constructor(e,a){this.length=e,this.name=a}hit(){this.hits+=1}isSunk(){this.hits===this.length&&(this.sunk=!0)}setCords(e,a){const t=[a,e];this.coords.push(t)}},a=class{board=[["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""]];carrier=new e(5,"Carrier");battleship=new e(4,"Battleship");destroyer=new e(3,"Destroyer");submarine=new e(3,"Submarine");patrolBoat=new e(2,"Patrol Boat");ships=[this.carrier,this.battleship,this.destroyer,this.submarine,this.patrolBoat];checkLegalPlacement(e,a,t,r){return!0===a&&r+e.length<=10||!1===a&&t+e.length<=10}placeShip(e,a,t,r){if(!1===this.checkLegalPlacement(e,a,t,r))return"that is not a legal placement";for(let o=0;o<e.length;o+=1)!0===a?(this.board[r+o][t]="X",e.setCords(t,r+o)):!1===a&&(this.board[r][t+o]="X",e.setCords(t+o,r))}getShipAtCoords(e,a){const t=[a,e];let r,o=!1;if(this.ships.forEach((e=>{e.coords.forEach((a=>{JSON.stringify(a)===JSON.stringify(t)&&(r=e,o=!0)}))})),!0===o)return r}sinkShip(e){!0===e.sunk&&e.coords.forEach((e=>{this.board[e[0]][e[1]]="S"}))}recieveAttack(e,a){let t;""===this.board[a][e]?this.board[a][e]="M":"X"===this.board[a][e]&&(t=this.getShipAtCoords(e,a),this.board[a][e]="H",t.hit()),this.ships.forEach((e=>{e.isSunk()})),void 0!==t&&this.sinkShip(t)}checkAllShipsAreSunk(){let e=!0;return this.ships.forEach((a=>{!1===a.sunk&&(e=!1)})),e}},t=class{gameboard=new a;playerBoard=this.gameboard.board;constructor(e){this.name=e}attackEnemy(e,a,t){e.gameboard.recieveAttack(a,t)}computerMove(e){let a=Math.floor(10*Math.random()),t=Math.floor(10*Math.random()),r=!1;for(;!1===r;)""===e.gameboard.board[t][a]||"X"===e.gameboard.board[t][a]?(e.gameboard.recieveAttack(a,t),r=!0):(a=Math.floor(10*Math.random()),t=Math.floor(10*Math.random()))}};function r(e){const a=document.createElement("div");a.id="player-board",a.classList.add("board");for(let t=0;t<e.gameboard.board.length;t+=1){const r=document.createElement("div");r.classList.add("row");for(let a=0;a<e.gameboard.board[t].length;a+=1){const o=document.createElement("div");if(o.classList.add("spot"),"X"===e.gameboard.board[t][a])o.innerText="X";else if("M"===e.gameboard.board[t][a]){const e=document.createElement("img");e.src="../assets/icons/waves.svg",e.classList.add("icon"),o.append(e)}else if("S"===e.gameboard.board[t][a]){const e=document.createElement("img");e.src="../assets/icons/skull.svg",e.classList.add("icon"),o.append(e)}else if("H"===e.gameboard.board[t][a]){const e=document.createElement("img");e.src="../assets/icons/explosion.svg",e.classList.add("icon"),o.append(e)}else o.innerText=e.gameboard.board[t][a];o.dataset.yCord=t,o.dataset.xCord=a,r.append(o)}a.append(r)}return a}function o(e,a){const t=document.createElement("div");t.id="enemy-board",t.classList.add("board");for(let s=0;s<e.gameboard.board.length;s+=1){const d=document.createElement("div");d.classList.add("row");for(let t=0;t<e.gameboard.board[s].length;t+=1){const n=document.createElement("div");if(n.classList.add("spot"),n.classList.add("enemy-spot"),"X"===e.gameboard.board[s][t])n.innerText="";else if("M"===e.gameboard.board[s][t]){const e=document.createElement("img");e.src="../assets/icons/waves.svg",e.classList.add("icon"),n.append(e)}else if("S"===e.gameboard.board[s][t]){const e=document.createElement("img");e.src="../assets/icons/skull.svg",e.classList.add("icon"),n.append(e)}else if("H"===e.gameboard.board[s][t]){const e=document.createElement("img");e.src="../assets/icons/explosion.svg",e.classList.add("icon"),n.append(e)}else n.innerText=e.gameboard.board[s][t];n.dataset.yCord=s,n.dataset.xCord=t,n.addEventListener("click",(()=>{const t=document.getElementById("enemy-board-container"),s=document.getElementById("player-board-container"),d=parseInt(n.dataset.yCord,10),i=parseInt(n.dataset.xCord,10);e.gameboard.recieveAttack(i,d),e.computerMove(a),t.innerHTML="",s.innerHTML="",t.append(o(e,a)),s.append(r(a))})),d.append(n)}t.append(d)}return t}const s={drawPlayerBoard:r,drawEnemyBoard:o,handleEnemyBoardClicks:function(e,a){const t=document.getElementById("enemy-board-container");document.querySelectorAll(".enemy-spot").forEach((r=>{r.addEventListener("click",(()=>{const s=parseInt(r.dataset.yCord,10),d=parseInt(r.dataset.xCord,10);e.attackEnemy(a,d,s),t.innerHTML="",t.append(o(a))}))}))}},d=new t("Boston"),n=new t("Computer");d.gameboard.placeShip(d.gameboard.carrier,!1,0,0),d.gameboard.placeShip(d.gameboard.battleship,!0,4,2),d.gameboard.placeShip(d.gameboard.patrolBoat,!1,3,7),d.gameboard.placeShip(d.gameboard.destroyer,!0,7,4),d.gameboard.placeShip(d.gameboard.submarine,!1,7,0),n.gameboard.placeShip(n.gameboard.carrier,!1,0,0),n.gameboard.placeShip(n.gameboard.battleship,!0,4,2),n.gameboard.placeShip(n.gameboard.patrolBoat,!1,3,7),n.gameboard.placeShip(n.gameboard.destroyer,!0,7,4),n.gameboard.placeShip(n.gameboard.submarine,!1,7,0);const i=document.createElement("div");i.id="enemy-board-container",i.append(s.drawEnemyBoard(n,d));const c=document.createElement("div");c.id="player-board-container",c.append(s.drawPlayerBoard(d)),document.body.prepend(c),document.body.prepend(i)})();